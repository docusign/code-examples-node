<%- include("../../partials/examplesHead") %>

<%- include("../../partials/exampleInfo") %>

<% if (workspaceIdOk) { %>
  <form class="eg" action="" method="post" data-busy="form">
    <% if(example.Forms && example.Forms[0].FormName) { %>
      <%- example.Forms[0].FormName %>
    <% } %>

    <div class="form-group">
      <label for="documentName"><%= example.Forms[0].Inputs[0].InputName %></label>
      <input type="text" class="form-control" id="documentName" placeholder="<%= example.Forms[0].Inputs[0].InputPlaceholder %>" 
             name="documentName" required>
    </div>

    <div class="form-group">
      <label for="documentPath"><%= example.Forms[0].Inputs[1].InputName %></label>
      <input type="file" accept=".pdf" class="form-control" id="documentPath" placeholder="<%= example.Forms[0].Inputs[1].InputPlaceholder %>" 
             name="documentPath" required>
      <small id="error" class="form-text text-muted"></small>
    </div>

    <input type="hidden" name="_csrf" value="<%- csrfToken %>">
    <%- include("../../partials/submitButton") %>
  </form>

  <script>
    const fileInput = document.getElementById('documentPath');
    const errorEl = document.getElementById('error');

    fileInput.addEventListener('change', (e) => {
      const file = fileInput.files[0];

      // Check extension
      const isPdf = file.name.toLowerCase().endsWith('.pdf');
      const isPdfMime = file.type === 'application/pdf';

      if (!isPdf || !isPdfMime) {
        fileInput.value = ''; // reset file input
        errorEl.textContent = 'Invalid file type. Please upload a PDF file.';
      } else {
        errorEl.textContent = ''; // clear any previous errors
      }
    });
  </script>
<% } else { %>
  <%- formatString(example.RedirectsToOtherCodeExamples[0].RedirectText, formatString('href="work00{0}"', example.RedirectsToOtherCodeExamples[0].CodeExampleToRedirectTo)) %>
  <form class="eg" action="work001" method="get">
      <%- include("../../partials/continueButton") %>
  </form>
<% } %>
  
<%- include("../../partials/examplesFoot") %>
